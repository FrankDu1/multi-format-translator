<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æ¡£ç¿»è¯‘å·¥å…· - å›¾ç‰‡ç¿»è¯‘ã€PDFç¿»è¯‘ã€PPTç¿»è¯‘ | è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¿æŒåŸæ ¼å¼ | ä¹å®¶</title>
    
    <!-- SEO ä¼˜åŒ–: æ–°å¢å…ƒæè¿° -->
    <meta name="description" content="å¼ºå¤§çš„æ–‡æ¡£ç¿»è¯‘å·¥å…·ï¼Œæ”¯æŒå›¾ç‰‡ç¿»è¯‘ï¼ˆJPG/PNG/BMP/TIFF/WebPï¼‰ã€PDFç¿»è¯‘ï¼ˆä¿æŒåŸæ ¼å¼ï¼‰ã€PPTç¿»è¯‘ã€æ–‡æœ¬ç¿»è¯‘ã€‚è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¸­è‹±æ–‡äº’è¯‘ï¼Œå¿«é€Ÿå‡†ç¡®ã€‚å…è´¹ä½¿ç”¨ï¼Œå®‰å…¨å¯é ã€‚">

    <!-- SEO ä¼˜åŒ–: æ·»åŠ å…³é”®è¯ -->
    <meta name="keywords" content="æ–‡æ¡£ç¿»è¯‘, å›¾ç‰‡ç¿»è¯‘, PDFç¿»è¯‘, PPTç¿»è¯‘, Wordç¿»è¯‘, æ–‡æœ¬ç¿»è¯‘, è‡ªåŠ¨è¯­è¨€æ£€æµ‹, ä¸­è‹±æ–‡äº’è¯‘, æ–‡æ¡£è½¬æ¢, æ ¼å¼ä¿æŒ, ä¹å®¶ç¿»è¯‘å·¥å…·">

    <!-- SEO ä¼˜åŒ–: æ·»åŠ  robots æ ‡ç­¾ -->
    <meta name="robots" content="index, follow">

    <!-- SEO ä¼˜åŒ–: æ·»åŠ  canonical URL -->
    <link rel="canonical" href="https://offerupup.cn/trans">

    <!-- SEO ä¼˜åŒ–: Open Graph æ ‡ç­¾ -->
    <meta property="og:title" content="æ–‡æ¡£ç¿»è¯‘å·¥å…· - æ”¯æŒPDFã€Wordã€å›¾ç‰‡ã€PPTåœ¨çº¿ç¿»è¯‘ | ä¹å®¶">
    <meta property="og:description" content="å¼ºå¤§çš„æ–‡æ¡£ç¿»è¯‘å·¥å…·ï¼Œæ”¯æŒå›¾ç‰‡ç¿»è¯‘ã€PDFç¿»è¯‘ã€PPTç¿»è¯‘ã€‚è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¿æŒåŸæ ¼å¼ï¼Œå¿«é€Ÿå‡†ç¡®ã€‚">
    <meta property="og:image" content="https://offerupup.cn/static/images/logo.png">
    <meta property="og:url" content="https://offerupup.cn/trans">
    <meta property="og:type" content="website">

    <!-- SEO ä¼˜åŒ–: Twitter Card æ ‡ç­¾ -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="æ–‡æ¡£ç¿»è¯‘å·¥å…· - æ”¯æŒPDFã€Wordã€å›¾ç‰‡ã€PPTåœ¨çº¿ç¿»è¯‘ | ä¹å®¶">
    <meta name="twitter:description" content="å¼ºå¤§çš„æ–‡æ¡£ç¿»è¯‘å·¥å…·ï¼Œæ”¯æŒå›¾ç‰‡ç¿»è¯‘ã€PDFç¿»è¯‘ã€PPTç¿»è¯‘ã€‚è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¿æŒåŸæ ¼å¼ï¼Œå¿«é€Ÿå‡†ç¡®ã€‚">
    <meta name="twitter:image" content="https://offerupup.cn/static/images/logo.png">

    <!-- SEO ä¼˜åŒ–: ç»“æ„åŒ–æ•°æ® (Schema.org WebApplication) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "æ–‡æ¡£ç¿»è¯‘å·¥å…·",
        "description": "å¼ºå¤§çš„æ–‡æ¡£ç¿»è¯‘å·¥å…·ï¼Œæ”¯æŒå›¾ç‰‡ç¿»è¯‘ï¼ˆå¤šç§æ ¼å¼ï¼‰ã€PDFç¿»è¯‘ï¼ˆä¿æŒåŸæ ¼å¼ï¼‰ã€PPTç¿»è¯‘ã€æ–‡æœ¬ç¿»è¯‘ã€‚è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¸­è‹±æ–‡äº’è¯‘ï¼Œå¿«é€Ÿå‡†ç¡®ã€‚",
        "url": "https://offerupup.cn/trans",
        "applicationCategory": "Utility",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "CNY"
        },
        "creator": {
            "@type": "Organization",
            "name": "ä¹å®¶",
            "url": "https://offerupup.cn"
        },
        "featureList": [
            "å›¾ç‰‡ç¿»è¯‘ï¼šæ”¯æŒJPGã€PNGã€BMPã€TIFFã€WebPæ ¼å¼ï¼Œè‡ªåŠ¨è¯†åˆ«æ–‡å­—",
            "PDFç¿»è¯‘ï¼šä¿æŒåŸæ–‡æ¡£æ ¼å¼å’Œæ ·å¼ï¼Œä¸“ä¸šçº§ç¿»è¯‘",
            "PPTç¿»è¯‘ï¼šå¹»ç¯ç‰‡ç¿»è¯‘ï¼Œæ”¯æŒPPTX/PPTæ ¼å¼",
            "æ–‡æœ¬ç¿»è¯‘ï¼šä¸­è‹±æ–‡äº’è¯‘ï¼Œè‡ªåŠ¨æ£€æµ‹è¯­è¨€",
            "å¤šæ ¼å¼æ”¯æŒï¼šWordã€TXTæ–‡æ¡£ç¿»è¯‘",
            "å¿«é€Ÿå‡†ç¡®ï¼šAIé©±åŠ¨ï¼Œå®‰å…¨å…è´¹"
        ]
    }
    </script>
    
    <!-- âŒ åˆ é™¤è¿™äº› meta æ ‡ç­¾ï¼ˆå·²ç»ä» .env è¯»å–äº†ï¼‰ -->
    <!-- ç¯å¢ƒå˜é‡æ³¨å…¥ - ç”±æœåŠ¡å™¨æˆ–æ„å»ºå·¥å…·å¡«å…… -->
    <script>
        window.ENV = {
            API_BASE_URL: (function() {
                // ä» meta æ ‡ç­¾è¯»å–é…ç½®ï¼ˆç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰
                const metaTag = document.querySelector('meta[name="env:API_BASE_URL"]');
                if (metaTag) {
                    return metaTag.getAttribute('content');
                }
                // é»˜è®¤æœ¬åœ°å¼€å‘é…ç½®
                const hostname = window.location.hostname;
                if (hostname === 'localhost' || hostname === '127.0.0.1') {
                    return 'http://localhost:5002/api';
                } else {
                    return window.location.origin + '/translator-api/api';
                }
            })()
        };
    </script>
    <!-- <meta name="env:API_BASE_URL" content="http://localhost:5002/api"> -->
    <!-- <meta name="env:APP_ENV" content="production"> -->
    <!-- <meta name="env:VERSION" content="3.0.0"> -->
    <!-- <meta name="env:APP_NAME" content="Image Translator"> -->
    
    <link rel="stylesheet" href="/static/css/style.css?v=202510220071">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="title-section">
                    <div class="logo-container">
                        <img src="/static/images/offerupup logo.png" alt="Logo" class="logo-image" onerror="this.style.display='none'">
                        <div>
                            <h1><i class="fas fa-language"></i> <span data-i18n="title">æ–‡æ¡£ç¿»è¯‘å·¥å…·</span></h1>
                            <p class="subtitle" data-i18n="subtitle">æ”¯æŒPDFã€Wordã€TXTæ–‡æ¡£ç¿»è¯‘ï¼Œå›¾ç‰‡ç¿»è¯‘ï¼ˆå¤šç§æ ¼å¼ï¼Œè‡ªåŠ¨è¯†åˆ«ï¼‰å’ŒPPTç¿»è¯‘ã€‚è‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¿æŒåŸæ ¼å¼ï¼Œå¿«é€Ÿå‡†ç¡®ã€‚</p>
                        </div>
                    </div>
                </div>
                <div class="language-switcher">
                    <button class="lang-btn active" id="langZh" onclick="switchLanguage('zh')">
                        <i class="fas fa-globe"></i> <span data-i18n="chinese">ä¸­æ–‡</span>
                    </button>
                    <button class="lang-btn" id="langEn" onclick="switchLanguage('en')">
                        <i class="fas fa-globe"></i> <span data-i18n="english">English</span>
                    </button>
                </div>
            </div>
        </header>

        <div class="main-content">
            <!-- è¯­è¨€é€‰æ‹©åŒºåŸŸ -->
            <div class="language-section">
                <div class="language-card">
                    <h3><i class="fas fa-cog"></i> <span data-i18n="translation_settings">ç¿»è¯‘è®¾ç½®</span></h3>
                    
                    <div class="language-controls-wrapper">
                        <!-- è¯­è¨€é€‰æ‹© -->
                        <div class="language-options">
                            <div class="language-group">
                                <label for="sourceLanguage" data-i18n="source_language">æºè¯­è¨€:</label>
                                <select id="sourceLanguage" class="language-select">
                                    <option value="zh" data-i18n="chinese">ä¸­æ–‡</option>
                                    <option value="en" data-i18n="english" selected>è‹±æ–‡</option>
                                    <option value="de" data-i18n="german">å¾·è¯­</option>
                                </select>
                            </div>

                            <div class="arrow-icon">
                                <i class="fas fa-arrow-right"></i>
                            </div>

                            <!-- ç›®æ ‡è¯­è¨€ -->
                            <div class="language-group">
                                <label for="targetLanguage" data-i18n="target_language">ç›®æ ‡è¯­è¨€:</label>
                                <select id="targetLanguage" class="language-select">
                                    <option value="en" data-i18n="english">è‹±æ–‡</option>
                                    <option value="zh" data-i18n="chinese" selected>ä¸­æ–‡</option>
                                    <option value="de" data-i18n="german">å¾·è¯­</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- AIæ€»ç»“å¼€å…³ -->
                        <div class="ai-summary-option">
                            <label class="switch-label">
                                <input type="checkbox" id="aiSummarySwitch" class="switch-input">
                                <span class="switch-slider"></span>
                                <span class="switch-text">
                                    <i class="fas fa-brain"></i> <span data-i18n="ai_summary">AIæ€»ç»“</span>
                                </span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- ğŸ”¥ æ–°å¢: é€šç”¨çš„AIæ€»ç»“æ˜¾ç¤ºåŒºåŸŸ (æ‰€æœ‰tabå…±äº«) -->
                <div class="ai-summary-card" id="aiSummaryCard" style="display:none;">
                    <!-- æ€»ç»“æˆåŠŸæ˜¾ç¤º -->
                    <div id="aiSummarySuccess" style="display:none;">
                        <div class="summary-header">
                            <h3><i class="fas fa-brain"></i> <span data-i18n="ai_summary">AI æ™ºèƒ½æ€»ç»“</span></h3>
                        </div>
                        <div id="aiSummaryContent" class="summary-content"></div>
                    </div>
                    
                    <!-- æ€»ç»“å¤±è´¥æ˜¾ç¤º -->
                    <div id="aiSummaryError" style="display:none;">
                        <div class="summary-header error">
                            <h3><i class="fas fa-exclamation-triangle"></i> <span data-i18n="ai_summary">AI æ€»ç»“</span></h3>
                        </div>
                        <div class="summary-error-message">
                            <i class="fas fa-info-circle"></i>
                            <span id="aiSummaryErrorText"></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åŠŸèƒ½é€‰æ‹©æ ‡ç­¾ - ä¿®å¤æ‰€æœ‰æŒ‰é’® -->
            <div class="tab-section">
                <div class="tab-buttons-container">
                    <div class="tab-buttons-grid">
                        <!-- âœ… æ–‡æœ¬è¾“å…¥æ ‡ç­¾ - å·²æ­£ç¡® -->
                        <button id="textTabBtn" onclick="switchTab('text')" class="tab-btn-modern active">
                            <i class="fas fa-edit"></i>
                            <span data-i18n="text_input">æ–‡æœ¬è¾“å…¥</span>
                        </button>
                        
                        <!-- âŒ PDFç¿»è¯‘æ ‡ç­¾ - éœ€è¦ä¿®å¤ -->
                        <button class="tab-btn-modern" onclick="switchTab('pdf')" id="pdfTab">
                            <i class="fas fa-file-pdf"></i>
                            <span data-i18n="pdf_translation">PDF ç¿»è¯‘</span>
                        </button>
                        
                        <!-- âŒ å›¾ç‰‡ç¿»è¯‘æ ‡ç­¾ - éœ€è¦ä¿®å¤ -->
                        <button id="imageTabBtn" onclick="switchTab('image')" class="tab-btn-modern">
                            <i class="fas fa-image"></i>
                            <span data-i18n="image_translation">å›¾ç‰‡ç¿»è¯‘</span>
                        </button>
                        
                        <!-- âŒ PPTç¿»è¯‘æ ‡ç­¾ - éœ€è¦ä¿®å¤ -->
                        <button id="pptTabBtn" class="tab-btn-modern" onclick="switchTab('ppt')">
                            <i class="fas fa-file-powerpoint"></i>
                            <span data-i18n="ppt_translation">PPTç¿»è¯‘</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- æ–‡æœ¬è¾“å…¥åŒºåŸŸ -->
            <div class="text-input-section" id="textInputSection">
                <div class="text-input-area">
                    <div class="input-header">
                        <h3><i class="fas fa-edit"></i> <span data-i18n="input_text">è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬</span></h3>
                        <div class="text-actions">
                            <button class="btn btn-secondary btn-small" onclick="clearTextInput()">
                                <i class="fas fa-eraser"></i> <span data-i18n="clear">æ¸…ç©º</span>
                            </button>
                            <button class="btn btn-primary" id="translateTextBtn" type="button" disabled>
                                <i class="fas fa-language"></i> <span data-i18n="start_translate">å¼€å§‹ç¿»è¯‘</span>
                            </button>
                        </div>
                    </div>
                    <textarea id="textInput" class="text-input" data-i18n-placeholder="input_placeholder" placeholder="è¯·åœ¨æ­¤å¤„è¾“å…¥æˆ–ç²˜è´´è¦ç¿»è¯‘çš„æ–‡æœ¬å†…å®¹...&#10;&#10;æ”¯æŒä¸­æ–‡å’Œè‹±æ–‡æ–‡æœ¬ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹è¯­è¨€å¹¶ç¿»è¯‘ã€‚" rows="12"></textarea>
                    <div class="input-footer">
                        <span class="char-count" data-i18n="char_count">å­—ç¬¦æ•°: <span id="charCount">0</span></span>
                        <span class="input-hint" data-i18n="input_hint">æ”¯æŒè‡ªåŠ¨æ£€æµ‹è¯­è¨€ï¼Œä¹Ÿå¯æ‰‹åŠ¨é€‰æ‹©æºè¯­è¨€å’Œç›®æ ‡è¯­è¨€</span>
                    </div>
                </div>
            </div>

            <!-- PDFæ ¼å¼ç¿»è¯‘åŒºåŸŸ -->
            <div class="pdf-format-section" id="pdfFormatSection" style="display: none;">
                <div class="pdf-upload-area">
                    <div class="upload-area" id="pdfUploadArea">
                        <i class="fas fa-file-pdf upload-icon"></i>
                        <h3 data-i18n="pdf_upload_title">ä¸Šä¼ PDFæ–‡æ¡£è¿›è¡Œæ ¼å¼ç¿»è¯‘</h3>
                        <p data-i18n="pdf_upload_subtitle">ç¿»è¯‘åä¿æŒåŸæ–‡æ¡£æ ¼å¼å’Œæ ·å¼ï¼Œä¸“ä¸šçº§PDFç¿»è¯‘ï¼Œè‡ªåŠ¨æ£€æµ‹è¯­è¨€ã€‚</p>
                        <input type="file" id="pdfFileInput" accept=".pdf" style="display: none;" onchange="handlePdfFileChange(event)">
                        <button class="btn btn-primary" onclick="document.getElementById('pdfFileInput').click()">
                            <i class="fas fa-file-pdf"></i> <span data-i18n="select_pdf">é€‰æ‹©PDFæ–‡ä»¶</span>
                        </button>
                    </div>
                </div>

                <!-- PDFç¿»è¯‘ç»“æœåŒºåŸŸï¼ˆç¾è§‚å¡ç‰‡é£æ ¼ï¼‰ -->
                <div class="pdf-download-card" id="pdfDownloadCard" style="display: none;">
                    <div class="pdf-download-icon">
                        <i class="fas fa-file-pdf" style="font-size: 48px; color: #d32f2f;"></i>
                    </div>
                    <h3 class="pdf-download-title">
                        <i class="fas fa-check-circle text-success"></i> <span data-i18n="pdf_translation_complete">PDFç¿»è¯‘å®Œæˆ</span>
                    </h3>
                    <div class="pdf-download-info" id="pdfDownloadInfo"></div>
                    <div class="pdf-download-actions">
                        <button class="btn btn-primary" id="downloadPdfBtn">
                            <i class="fas fa-download"></i> <span data-i18n="download_translated_pdf">ä¸‹è½½ç¿»è¯‘åçš„PDF</span>
                        </button>
                        <button class="btn btn-secondary" id="reselectPdfBtn">
                            <i class="fas fa-redo"></i> <span data-i18n="retranslate">ç¿»è¯‘æ–°PDF</span>
                        </button>
                    </div>
                </div>

                <!-- ä¸Šä¼ åŒºåŸŸçš„æŒ‰é’®ä¸€è¡Œæ˜¾ç¤ºï¼ˆç¤ºä¾‹ï¼‰ -->
                <div class="pdf-upload-actions" style="display: flex; gap: 16px; margin-top: 24px;">
                    <button class="btn btn-success" id="pdfTranslateBtn" onclick="translatePdfFile()">
                        <i class="fas fa-language"></i> <span data-i18n="start_translate">å¼€å§‹ç¿»è¯‘</span>
                    </button>
                    <button class="btn btn-secondary" id="clearPdfBtn" onclick="clearPdfFile()">
                        <i class="fas fa-times"></i> <span data-i18n="reselect">é‡æ–°é€‰æ‹©</span>
                    </button>
                </div>
            </div>

            <!-- ç¿»è¯‘ç»“æœæ˜¾ç¤ºåŒºåŸŸï¼ˆæ–‡æœ¬æ¨¡å¼ï¼‰ -->
            <div class="text-result-section" id="textResultSection" style="display: none;">
                <div class="text-result-content">
                    <div class="result-header">
                        <h3><i class="fas fa-check-circle text-success"></i> <span data-i18n="translation_complete">ç¿»è¯‘å®Œæˆ</span></h3>
                        <div class="result-actions">
                            <button class="btn btn-primary" onclick="copyToClipboard()">
                                <i class="fas fa-copy"></i> <span data-i18n="copy_result">å¤åˆ¶ç»“æœ</span>
                            </button>
                            <button class="btn btn-success" onclick="downloadTextResult()">
                                <i class="fas fa-download"></i> <span data-i18n="download_text">ä¸‹è½½è¯‘æ–‡</span>
                            </button>
                            <button class="btn btn-secondary" onclick="resetTextTranslation()">
                                <i class="fas fa-redo"></i> <span data-i18n="retranslate">é‡æ–°ç¿»è¯‘</span>
                            </button>
                        </div>
                    </div>
                    <div class="text-column">
                            <h4 data-i18n="translated_text">è¯‘æ–‡</h4>
                            <div class="text-display" id="translatedTextDisplay"></div>
                            <div class="text-info">
                                <span id="translatedInfo"></span>
                            </div>
                    </div>
                </div>
            </div>

            <!-- å›¾ç‰‡ç¿»è¯‘åŒºåŸŸ -->
            <div class="image-translation-section" id="imageTranslationSection" style="display: none;">
                <div class="image-upload-area">
                    <div class="image-upload-container">
                        <div class="image-upload-box" onclick="document.getElementById('imageFileInput').click()">
                            <i class="fas fa-image upload-icon"></i>
                            <h3 data-i18n="select_image">é€‰æ‹©å›¾ç‰‡æ–‡ä»¶</h3>
                            <p data-i18n="image_tip">æ”¯æŒ JPGã€PNGã€BMPã€TIFFã€WebP æ ¼å¼ï¼Œè‡ªåŠ¨è¯†åˆ«å›¾ç‰‡ä¸­çš„æ–‡å­—ï¼Œç²¾å‡†ç¿»è¯‘ã€‚</p>
                            <input type="file" id="imageFileInput" accept=".jpg,.jpeg,.png,.bmp,.tiff,.webp" style="display: none;" onchange="handleImageFile(this)">
                        </div>
                        

                        <div class="image-preview" id="imagePreview" style="display: none;">
                            <img id="previewImage" src="" alt="é¢„è§ˆå›¾ç‰‡" style="max-width: 100%; max-height: 300px; border-radius: 8px;">
                            <div class="image-info">
                                <span id="imageFileName"></span>
                                <span id="imageFileSize"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="image-translation-controls">
                        <button class="btn btn-primary btn-large" id="translateImageBtn" onclick="translateImage()" disabled>
                            <i class="fas fa-language"></i> <span data-i18n="start_translate_img">å¼€å§‹ç¿»è¯‘å›¾ç‰‡</span>
                        </button>
                    </div>
                </div>
                
                <div class="image-result-container" id="imageResultContainer" style="display: none;">
                    <div class="image-comparison">
                        <div class="image-column">
                            <h4><i class="fas fa-file-image"></i> <span data-i18n="original_image">åŸå§‹å›¾ç‰‡</span></h4>
                            <img id="originalImage" src="" alt="åŸå§‹å›¾ç‰‡" style="max-width: 100%; border-radius: 8px;">
                        </div>
                        <div class="arrow-separator">
                            <i class="fas fa-arrow-right"></i>
                        </div>
                        <div class="image-column">
                            <h4><i class="fas fa-language"></i> <span data-i18n="translated_image">ç¿»è¯‘åå›¾ç‰‡</span></h4>
                            <img id="translatedImage" src="" alt="ç¿»è¯‘åå›¾ç‰‡" style="max-width: 100%; border-radius: 8px;">
                            <div class="image-actions">
                                <button class="btn btn-success" onclick="downloadTranslatedImage()">
                                    <i class="fas fa-download"></i> <span data-i18n="download_translated_image">ä¸‹è½½ç¿»è¯‘åå›¾ç‰‡</span>
                                </button>
                                <button class="btn btn-secondary" onclick="resetImageTranslation()">
                                    <i class="fas fa-redo"></i> <span data-i18n="retranslate">ç¿»è¯‘æ–°å›¾ç‰‡</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PPTç¿»è¯‘åŒºåŸŸ -->
            <div class="ppt-translation-section" id="pptTranslationSection" style="display: none;">
                <div class="ppt-upload-area">
                    <div class="ppt-upload-container">
                        <div class="ppt-upload-box" onclick="document.getElementById('pptFileInput').click()">
                            <i class="fas fa-file-powerpoint upload-icon"></i>
                            <h3 data-i18n="select_ppt">é€‰æ‹©PPTæ–‡ä»¶</h3>
                            <p data-i18n="ppt_support">æ”¯æŒ PPTXã€PPT æ ¼å¼</p>
                            <input type="file" id="pptFileInput" accept=".pptx,.ppt" style="display: none;" onchange="handlePPTFile(this)">
                        </div>
                        
                        <div class="ppt-preview" id="pptPreview" style="display: none;">
                            <div class="ppt-info">
                                <i class="fas fa-file-powerpoint" style="font-size: 48px; color: #fd7e14;"></i>
                                <div class="ppt-details">
                                    <span id="pptFileName"></span>
                                    <span id="pptFileSize"></span>
                                    <span id="pptSlideCount"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ppt-translation-controls">
                        <button class="btn btn-primary btn-large" id="translatePPTBtn" onclick="translatePPT()" disabled>
                            <i class="fas fa-language"></i> <span data-i18n="start_translate_ppt">å¼€å§‹ç¿»è¯‘PPT</span>
                        </button>
                    </div>
                </div>
                
                <div class="ppt-result-container" id="pptResultContainer" style="display: none;">
                    <div class="ppt-result-header">
                        <h3><i class="fas fa-check-circle text-success"></i> <span data-i18n="ppt_translation_complete">PPTç¿»è¯‘å®Œæˆ</span></h3>
                        <div class="ppt-result-actions">
                            <button class="btn btn-success btn-large" onclick="downloadTranslatedPPT()">
                                <i class="fas fa-download"></i> <span data-i18n="download_translated_ppt">ä¸‹è½½ç¿»è¯‘åPPT</span>
                            </button>
                            <button class="btn btn-secondary" onclick="resetPPTTranslation()">
                                <i class="fas fa-redo"></i> <span data-i18n="retranslate">ç¿»è¯‘æ–°PPT</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="ppt-result-info">
                        <div class="result-stats">
                            <div class="stat-item">
                                <i class="fas fa-file-powerpoint"></i>
                                <span data-i18n="original_ppt_label">åŸå§‹PPT</span>
                                <strong id="originalPPTName">example.pptx</strong>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-language"></i>
                                <span data-i18n="translated_ppt_label">ç¿»è¯‘ç»“æœ</span>
                                <strong id="translatedPPTName">translated_example.pptx</strong>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-chart-bar"></i>
                                <span data-i18n="ppt_translation_stats_label">ç¿»è¯‘ç»Ÿè®¡</span>
                                <strong id="pptTranslationStats">0/0 é¡¹å®Œæˆ</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è¿›åº¦æ˜¾ç¤ºåŒºåŸŸ -->
            <div class="progress-section" id="progressSection" style="display: none;">
                <div class="progress-card">
                    <h3><i class="fas fa-cog fa-spin"></i> <span data-i18n="translating_progress">ç¿»è¯‘è¿›è¡Œä¸­...</span></h3>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="progressText" data-i18n="processing">æ­£åœ¨å¤„ç†æ–‡æ¡£...</p>
                </div>
            </div>

            <!-- ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
            <div class="result-section" id="resultSection" style="display: none;">
                <div class="result-header">
                    <h3><i class="fas fa-check-circle text-success"></i> <span data-i18n="translation_complete">ç¿»è¯‘å®Œæˆ</span></h3>
                    <div class="result-actions">
                        <button class="btn btn-primary" id="downloadBtn">
                            <i class="fas fa-download"></i> <span data-i18n="download_file">ä¸‹è½½ç¿»è¯‘æ–‡ä»¶</span>
                        </button>
                        <button class="btn btn-secondary" onclick="resetApp()">
                            <i class="fas fa-redo"></i> <span data-i18n="translate_new">ç¿»è¯‘æ–°æ–‡æ¡£</span>
                        </button>
                    </div>
                </div>
                
                <div class="result-content">
                    <div class="text-preview">
                        <h4 data-i18n="translation_preview">ç¿»è¯‘é¢„è§ˆï¼š</h4>
                        <div class="text-box" id="translatedText"></div>
                    </div>
                </div>
            </div>

            <!-- é”™è¯¯æç¤ºåŒºåŸŸ -->
            <div class="error-section" id="errorSection" style="display: none;">
                <div class="error-card">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h3 data-i18n="processing_failed">å¤„ç†å¤±è´¥</h3>
                    <p id="errorMessage"></p>
                    <button class="btn btn-secondary" onclick="resetApp()">
                        <i class="fas fa-redo"></i> <span data-i18n="restart">é‡æ–°å¼€å§‹</span>
                    </button>
                </div>
            </div>

            <!-- PDFä¸‹è½½ç»“æœåŒºåŸŸ -->
            <div class="pdf-download-container" id="pdfDownloadContainer" style="display: none;">
                <div class="pdf-download-header">
                    <h3><i class="fas fa-check-circle text-success"></i> <span data-i18n="pdf_translation_complete">PDFç¿»è¯‘å®Œæˆ</span></h3>
                     <p id="pdfDownloadInfo"></p>
                     <button class="btn btn-primary" id="downloadPdfBtn">
                         <i class="fas fa-download"></i> <span data-i18n="download_translated_pdf">ä¸‹è½½ç¿»è¯‘åçš„PDF</span>
                     </button>
                    <button class="btn btn-secondary" onclick="resetPdfTranslation()">
                        <i class="fas fa-redo"></i> <span data-i18n="retranslate">ç¿»è¯‘æ–°PDF</span>
                    </button>
                 </div>
             </div>

            <!-- AI æ€»ç»“åŒºåŸŸï¼ˆé»˜è®¤éšè—ï¼‰ -->
            <div id="aiSummarySection" style="display:none">
                <h3 data-i18n="ai_summary">AI æ€»ç»“</h3>
                <div id="aiSummaryContent"></div>
            </div>
        </div>
        
        <!-- ğŸ”¥ æ›´æ–°footerå†…å®¹ï¼Œä¸ä¸»é¡µä¸€è‡´ -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="https://beian.miit.gov.cn/" target="_blank" rel="nofollow">äº¬ICPå¤‡2025108783å·</a>
                    <span class="separator">|</span>
                    <a href="mailto:offerupup@offerupup.cn">è”ç³»æ–¹å¼ï¼šofferupup@offerupup.cn</a>
                    <span class="separator">|</span>
                    <span>Â© 2025 ä¹å®¶</span>
                    <span class="separator">|</span>
                    <a href="https://offerupup.cn/privacy" target="_blank">éšç§æ”¿ç­–</a>
                    <span class="separator">|</span>
                    <a href="https://www.xiaohongshu.com/user/profile/64f2bd6300000000060303f3" target="_blank" rel="nofollow">å°çº¢ä¹¦</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- ğŸ”¥ åˆ é™¤æˆ–æ³¨é‡Šæ‰è¿™ä¸€è¡Œï¼Œå› ä¸ºå‡½æ•°å·²ç»åœ¨ä¸‹é¢å®šä¹‰äº† -->
    <!-- <script src="/static/js/tabs.js?v=20251022001"></script> -->
    
    <!-- âœ… æ–°å¢ï¼šåœ¨åŠ è½½å…¶ä»–JSä¹‹å‰å®šä¹‰ ENV_CONFIG -->
    <script>
        window.ENV_CONFIG = {
            API_BASE_URL: (() => {
                const hostname = window.location.hostname;
                if (hostname === 'localhost' || hostname === '127.0.0.1') {
                    return 'http://localhost:5002/api';
                } else {
                    return 'https://offerupup.cn/translator-api/api';
                }
            })(),
            
            APP_ENV: window.location.hostname === 'localhost' ? 'development' : 'production',
            VERSION: '3.0.0',
            APP_NAME: 'Image Translator',
            
            getApiUrl() {
                return this.API_BASE_URL;
            },
            
            getEnv() {
                return this.APP_ENV;
            },
            
            getVersion() {
                return this.VERSION;
            }
        };
        
        console.log('âœ… ENV_CONFIG å·²å®šä¹‰:', window.ENV_CONFIG.API_BASE_URL);
    </script>

    <script src="/static/js/env-config.js?v=20251016"></script>
    <script src="/static/js/i18n.js?v=20251224001"></script>
    <script src="/static/js/app.js?v=20250922"></script>
    
    <script>
        // ==========================================
        // ğŸ”¥ è¯­è¨€é€‰æ‹©å™¨è”åŠ¨é€»è¾‘
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ é¡µé¢åˆå§‹åŒ–...');
            
            // 1. åˆ‡æ¢åˆ°æ–‡æœ¬ç¿»è¯‘æ ‡ç­¾
            switchTab('text');
            
            // 2. ç»‘å®šæ–‡æœ¬è¾“å…¥äº‹ä»¶ç›‘å¬å™¨
            const textInput = document.getElementById('textInput');
            const translateTextBtn = document.getElementById('translateTextBtn');
            const charCount = document.getElementById('charCount');
            
            if (textInput && translateTextBtn) {
                textInput.addEventListener('input', function() {
                    const text = this.value.trim();
                    const hasText = text.length > 0;
                    translateTextBtn.disabled = !hasText;
                    if (charCount) {
                        charCount.textContent = text.length;
                    }
                });
                
                console.log('âœ… æ–‡æœ¬è¾“å…¥ç›‘å¬å™¨å·²ç»‘å®š');
                const initialText = textInput.value.trim();
                translateTextBtn.disabled = initialText.length === 0;
            } else {
                console.error('âŒ å…ƒç´ æœªæ‰¾åˆ°!');
            }
            
            // ğŸ”¥ 3. ç»‘å®šè¯­è¨€é€‰æ‹©å™¨è”åŠ¨é€»è¾‘
            const sourceLanguageSelect = document.getElementById('sourceLanguage');
            const targetLanguageSelect = document.getElementById('targetLanguage');
            
            if (sourceLanguageSelect && targetLanguageSelect) {
                // è·å–æ‰€æœ‰å¯ç”¨è¯­è¨€é€‰é¡¹
                const getAvailableLanguages = (excludeValue) => {
                    const allOptions = Array.from(targetLanguageSelect.options);
                    return allOptions
                        .map(opt => opt.value)
                        .filter(val => val !== excludeValue);
                };
                
                // éšæœºé€‰æ‹©ä¸€ä¸ªè¯­è¨€ï¼ˆæ’é™¤å½“å‰é€‰ä¸­çš„ï¼‰
                const selectRandomLanguage = (selectElement, excludeValue) => {
                    const availableLanguages = getAvailableLanguages(excludeValue);
                    if (availableLanguages.length > 0) {
                        const randomLang = availableLanguages[Math.floor(Math.random() * availableLanguages.length)];
                        selectElement.value = randomLang;
                        console.log(`ğŸ”„ è‡ªåŠ¨åˆ‡æ¢è¯­è¨€ä¸º: ${randomLang}`);
                    }
                };
                
                // ç›‘å¬æºè¯­è¨€å˜åŒ–
                sourceLanguageSelect.addEventListener('change', function() {
                    const selectedSource = this.value;
                    console.log(`ğŸ“ ç”¨æˆ·é€‰æ‹©æºè¯­è¨€: ${selectedSource}`);
                    
                    // å¦‚æœç›®æ ‡è¯­è¨€å’Œæºè¯­è¨€ç›¸åŒï¼Œè‡ªåŠ¨åˆ‡æ¢ç›®æ ‡è¯­è¨€
                    if (targetLanguageSelect.value === selectedSource) {
                        selectRandomLanguage(targetLanguageSelect, selectedSource);
                    }
                });
                
                // ç›‘å¬ç›®æ ‡è¯­è¨€å˜åŒ–
                targetLanguageSelect.addEventListener('change', function() {
                    const selectedTarget = this.value;
                    console.log(`ğŸ“ ç”¨æˆ·é€‰æ‹©ç›®æ ‡è¯­è¨€: ${selectedTarget}`);
                    
                    // å¦‚æœæºè¯­è¨€å’Œç›®æ ‡è¯­è¨€ç›¸åŒï¼Œè‡ªåŠ¨åˆ‡æ¢æºè¯­è¨€
                    if (sourceLanguageSelect.value === selectedTarget) {
                        selectRandomLanguage(sourceLanguageSelect, selectedTarget);
                    }
                });
                
                console.log('âœ… è¯­è¨€é€‰æ‹©å™¨è”åŠ¨é€»è¾‘å·²ç»‘å®š');
            } else {
                console.error('âŒ è¯­è¨€é€‰æ‹©å™¨æœªæ‰¾åˆ°!');
            }
        });
        
        // ==========================================
        // switchTab å‡½æ•°
        // ==========================================
        function switchTab(tabName) {
            // âŒ å¯é€‰ï¼šç§»é™¤åˆ‡æ¢æ ‡ç­¾çš„æ—¥å¿—
            // console.log('åˆ‡æ¢åˆ°æ ‡ç­¾:', tabName);
            
            // ç§»é™¤æ‰€æœ‰active
            document.querySelectorAll('.tab-btn-modern').forEach(t => t.classList.remove('active'));
            
            // æ¿€æ´»å½“å‰tabï¼ˆåªå¯¹æœªç¦ç”¨çš„æŒ‰é’®ï¼‰
            const btn = document.getElementById(tabName + 'TabBtn');
            if (btn && !btn.disabled) {
                btn.classList.add('active');
            }
            
            // éšè—æ‰€æœ‰section
            ['textInputSection', 'pdfFormatSection', 'imageTranslationSection', 'pptTranslationSection']
                .forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.style.display = 'none';
                });
            
            // æ˜¾ç¤ºç›®æ ‡section
            const map = {
                text: 'textInputSection', 
                pdf: 'pdfFormatSection', 
                image: 'imageTranslationSection', 
                ppt: 'pptTranslationSection'
            };
            const target = document.getElementById(map[tabName]);
            if (target) target.style.display = 'block';
        }
        
        // æ¸…ç©ºæ–‡æœ¬è¾“å…¥
        function clearTextInput() {
            const textInput = document.getElementById('textInput');
            const translateTextBtn = document.getElementById('translateTextBtn');
            const charCount = document.getElementById('charCount');
            
            if (textInput) textInput.value = '';
            if (translateTextBtn) translateTextBtn.disabled = true;
            if (charCount) charCount.textContent = '0';
            
            // âœ… ä¿ç•™æ¸…ç©ºæ“ä½œçš„æ—¥å¿—ï¼ˆä¸é¢‘ç¹ï¼‰
            console.log('âœ… æ–‡æœ¬å·²æ¸…ç©º');
        }
        
        // è°ƒè¯•æ£€æŸ¥å‡½æ•°
        function runDebugCheck() {
            const resultSpan = document.getElementById('debugResult');
            let results = [];
            
            // æ£€æŸ¥æ‰€æœ‰æ ‡ç­¾æŒ‰é’®
            const allButtons = document.querySelectorAll('.tab-btn');
            results.push(`æ—§æŒ‰é’®æ•°: ${allButtons.length}`);
            
            const newButtons = document.querySelectorAll('[id$="TabBtn"]');
            results.push(`æ–°æŒ‰é’®æ•°: ${newButtons.length}`);
            
            // æ£€æŸ¥æ¯ä¸ªæŒ‰é’®çš„çŠ¶æ€
            allButtons.forEach((btn, index) => {
                const styles = window.getComputedStyle(btn);
                const id = btn.id || `button-${index + 1}`;
                const text = btn.textContent.trim().substring(0, 10);
                results.push(`${id}(${text}): display=${styles.display}, visible=${styles.visibility}`);
            });
            
            // æ£€æŸ¥PDFç›¸å…³å…ƒç´ 
            const pdfTab = document.getElementById('pdfTab');
            if (pdfTab) {
                const pdfStyles = window.getComputedStyle(pdfTab);
                results.push(`PDFæ ‡ç­¾: å­˜åœ¨, display=${pdfStyles.display}`);
            } else {
                results.push('PDFæ ‡ç­¾: ä¸å­˜åœ¨ï¼');
            }
            
            const pdfSection = document.getElementById('pdfFormatSection');
            if (pdfSection) {
                results.push('PDFåŒºåŸŸ: å­˜åœ¨');
            } else {
                results.push('PDFåŒºåŸŸ: ä¸å­˜åœ¨ï¼');
            }
            
            // æ£€æŸ¥å®¹å™¨
            const tabButtons = document.querySelector('.tab-buttons');
            if (tabButtons) {
                const containerStyles = window.getComputedStyle(tabButtons);
                results.push(`å®¹å™¨: display=${containerStyles.display}, width=${containerStyles.width}`);
            }
            
            resultSpan.innerHTML = results.join('<br>');
            resultSpan.style.background = 'rgba(255,255,255,0.2)';
            resultSpan.style.padding = '10px';
            resultSpan.style.borderRadius = '5px';
            resultSpan.style.marginTop = '10px';
            resultSpan.style.display = 'inline-block';
        }
        
        // PDFç¿»è¯‘è°ƒè¯•å‡½æ•°
        function debugPdfTranslate() {
            console.log('=== PDFç¿»è¯‘è°ƒè¯• ===');
            console.log('currentPdfFile:', window.currentPdfFile);
            console.log('pdfFileInputå­˜åœ¨:', document.getElementById('pdfFileInput') !== null);
            console.log('pdfFileNameå­˜åœ¨:', document.getElementById('pdfFileName') !== null);
            console.log('pdfFileInfoæ˜¾ç¤ºçŠ¶æ€:', document.getElementById('pdfFileInfo')?.style.display);
            
            const sourceLanguage = document.getElementById('sourceLanguage')?.value;
            const targetLanguage = document.getElementById('targetLanguage')?.value;
            console.log('æºè¯­è¨€:', sourceLanguage);
            console.log('ç›®æ ‡è¯­è¨€:', targetLanguage);
            
            // æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶
            if (!window.currentPdfFile) {
                alert('è°ƒè¯•ä¿¡æ¯ï¼šæ²¡æœ‰é€‰æ‹©PDFæ–‡ä»¶ï¼è¯·å…ˆé€‰æ‹©ä¸€ä¸ªPDFæ–‡ä»¶ã€‚');
                return;
            }
            
            alert(`è°ƒè¯•ä¿¡æ¯ï¼š
æ–‡ä»¶å: ${window.currentPdfFile.name}
æ–‡ä»¶å¤§å°: ${(window.currentPdfFile.size / 1024 / 1024).toFixed(2)} MB
æ–‡ä»¶ç±»å‹: ${window.currentPdfFile.type}
æºè¯­è¨€: ${sourceLanguage}
ç›®æ ‡è¯­è¨€: ${targetLanguage}

ç‚¹å‡»ç¡®å®šåå°†å¼€å§‹ç¿»è¯‘...`);
            
            // è°ƒç”¨å®é™…çš„ç¿»è¯‘å‡½æ•°
            if (window.translatePdfFile) {
                window.translatePdfFile();
            } else {
                alert('é”™è¯¯ï¼štranslatePdfFileå‡½æ•°ä¸å­˜åœ¨ï¼');
            }
        }
        
        // PDFæ–‡ä»¶é€‰æ‹©å¤„ç†å‡½æ•°
        window.currentPdfFile = null;
        
        function handlePdfFileChange(event) {
            console.log('PDFæ–‡ä»¶é€‰æ‹©äº‹ä»¶è§¦å‘');
            const file = event.target.files[0];
            
            if (!file) {
                console.log('æ²¡æœ‰é€‰æ‹©æ–‡ä»¶');
                return;
            }
            
            console.log('é€‰æ‹©çš„æ–‡ä»¶:', file.name, file.type, file.size);
            
            if (file.type !== 'application/pdf') {
                alert('è¯·é€‰æ‹©PDFæ–‡ä»¶ï¼');
                return;
            }
            
            // è®¾ç½®å…¨å±€å˜é‡
            window.currentPdfFile = file;
            
            // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
            const pdfFileName = document.getElementById('pdfFileName');
            const pdfFileInfo = document.getElementById('pdfFileInfo');
            const pdfUploadArea = document.getElementById('pdfUploadArea');
            
            if (pdfFileName) {
                pdfFileName.textContent = file.name;
                console.log('æ–‡ä»¶åå·²è®¾ç½®:', file.name);
            }
            
            if (pdfFileInfo) {
                pdfFileInfo.style.display = 'block';
                console.log('æ–‡ä»¶ä¿¡æ¯åŒºåŸŸå·²æ˜¾ç¤º');
            }
            
            if (pdfUploadArea) {
                pdfUploadArea.style.display = 'none';
                console.log('ä¸Šä¼ åŒºåŸŸå·²éšè—');
            }
            
            // å¯ç”¨ç¿»è¯‘æŒ‰é’®
            const translateBtn = document.getElementById('pdfTranslateBtn2');
            if (translateBtn) {
                translateBtn.disabled = false;
                console.log('ç¿»è¯‘æŒ‰é’®å·²å¯ç”¨');
            }
            
            console.log('PDFæ–‡ä»¶å¤„ç†å®Œæˆï¼ŒcurrentPdfFileå·²è®¾ç½®');
        }
        
        // æ¸…é™¤PDFæ–‡ä»¶å‡½æ•°
        function clearPdfFile() {
            window.currentPdfFile = null;
            
            const pdfFileInput = document.getElementById('pdfFileInput');
            const pdfFileInfo = document.getElementById('pdfFileInfo');
            const pdfUploadArea = document.getElementById('pdfUploadArea');
            
            if (pdfFileInput) pdfFileInput.value = '';
            if (pdfFileInfo) pdfFileInfo.style.display = 'none';
            if (pdfUploadArea) pdfUploadArea.style.display = 'block';
            
            console.log('PDFæ–‡ä»¶å·²æ¸…é™¤');
        }
        
        // ç®€åŒ–çš„PDFç¿»è¯‘å‡½æ•°
        async function translatePdfFile() {
            if (!currentPdfFile) {
                alert('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶');
                return;
            }
            
            try {
                console.log('å¼€å§‹PDFç¿»è¯‘...');
                
                // æ˜¾ç¤ºè¿›åº¦
                const progressSection = document.getElementById('progressSection');
                if (progressSection) {
                    progressSection.style.display = 'block';
                    document.getElementById('progressText').textContent = 'æ­£åœ¨ç¿»è¯‘PDF...';
                }
                
                // å‡†å¤‡è¡¨å•æ•°æ®
                const formData = new FormData();
                formData.append('file', currentPdfFile);
                
                // ğŸ”¥ ä½¿ç”¨é€šç”¨è¯­è¨€é€‰æ‹©å™¨
                const sourceLang = document.getElementById('sourceLanguage')?.value;
                const targetLang = document.getElementById('targetLanguage')?.value;
                // è·å–AIæ€»ç»“å¼€å…³çŠ¶æ€
                const aiSummarySwitch = document.getElementById('aiSummarySwitch');
                const enableSummary = aiSummarySwitch ? aiSummarySwitch.checked : false;
                
                // è½¬æ¢è¯­è¨€ä»£ç 
                const langMap = {
                    'ä¸­æ–‡': 'zh',
                    'è‹±æ–‡': 'en',
                    'auto': 'auto',
                    'zh': 'zh',
                    'en': 'en'
                };
                
                const srcLangCode = langMap[sourceLang] || sourceLang || 'auto';
                const tgtLangCode = langMap[targetLang] || targetLang || 'zh';
                
                // ğŸ”¥ ä¿®å¤ï¼šä½¿ç”¨æ­£ç¡®çš„å‚æ•°å
                formData.append('source_lang', srcLangCode);  // âœ… æ”¹ä¸º source_lang
                formData.append('target_lang', tgtLangCode);  // âœ… æ”¹ä¸º target_lang
                formData.append('enable_summary', enableSummary); 

                console.log('ğŸŒ PDFç¿»è¯‘è¯­è¨€è®¾ç½®:', { 
                    æºè¯­è¨€: sourceLang,
                    ç›®æ ‡è¯­è¨€: targetLanguage,
                    source_lang: srcLangCode, 
                    target_lang: tgtLangCode 
                });
                
                // ğŸ” è°ƒè¯•ï¼šæ‰“å°FormDataå†…å®¹
                console.log('ğŸ“¦ PDF FormData å†…å®¹:');
                for (let pair of formData.entries()) {
                    console.log(`   ${pair[0]}: ${pair[1]}`);
                }
                
                // ğŸ”¥ ä½¿ç”¨ ENV_CONFIG è·å– API åœ°å€
                const apiBaseUrl = window.ENV_CONFIG.getApiUrl();
                const fullUrl = `${apiBaseUrl}/translate/pdf`;  // âœ… è°ƒç”¨ /translate/pdf
                console.log('ğŸŒ PDFå®Œæ•´è¯·æ±‚URL:', fullUrl);
                
                // å‘é€ç¿»è¯‘è¯·æ±‚
                const response = await fetch(fullUrl, {
                    method: 'POST',
                    body: formData
                });
                
                console.log('ğŸ“¥ æ”¶åˆ°PDFå“åº”ï¼ŒçŠ¶æ€ç :', response.status);
                
                const result = await response.json();
                console.log('âœ… PDFç¿»è¯‘ç»“æœ:', result);
                
                if (result.success) {
                    showPdfDownloadResult(result); // âœ… æ”¹ä¸ºè°ƒç”¨ä¸‹è½½ç»“æœæ˜¾ç¤º
                    if (result.summary) {
                        displayAISummary(result.summary);
                    } else {
                        hideAISummary();
                    }
                } else {
                    throw new Error(result.error || 'PDFç¿»è¯‘å¤±è´¥');
                }
                
            } catch (error) {
                console.error('âŒ PDFç¿»è¯‘å¤±è´¥:', error);
                alert('ç¿»è¯‘å¤±è´¥: ' + error.message);
            } finally {
                const progressSection = document.getElementById('progressSection');
                if (progressSection) {
                    progressSection.style.display = 'none';
                }
            }
        }

        // PDFä¸‹è½½ç»“æœæ˜¾ç¤ºï¼ˆå®Œå–„ç‰ˆï¼‰
        function showPdfDownloadResult(result) {
            console.log('ğŸ“Š æ˜¾ç¤ºPDFç¿»è¯‘ç»“æœï¼Œå®Œæ•´resultå¯¹è±¡:', result);
            
            const card = document.getElementById('pdfDownloadCard');
            const info = document.getElementById('pdfDownloadInfo');
            const downloadBtn = document.getElementById('downloadPdfBtn');
            const reselectBtn = document.getElementById('reselectPdfBtn');
            
            if (!card) {
                console.error('âŒ æ‰¾ä¸åˆ° pdfDownloadCard å…ƒç´ ');
                return;
            }
            
            // ğŸ”¥ è·å–ä¸‹è½½ URLï¼ˆä¸ PPT é€»è¾‘ä¸€è‡´ï¼‰
            let pdfUrl = result.download_url || 
                         result.file_url ||
                         result.url ||
                         result.translated_filename ||
                         result.filename;
            
            console.log('ğŸ” æå–åˆ°çš„åŸå§‹URL:', pdfUrl);
            
            // ğŸ”¥ ç»Ÿä¸€ URL æ‹¼æ¥é€»è¾‘
            if (pdfUrl) {
                if (pdfUrl.startsWith('http://') || pdfUrl.startsWith('https://')) {
                    // æ£€æŸ¥æ˜¯å¦éœ€è¦æ·»åŠ  translator-api å‰ç¼€
                    if (pdfUrl.includes('offerupup.cn') && !pdfUrl.includes('translator-api')) {
                        pdfUrl = pdfUrl.replace('/api/files/', '/translator-api/api/files/');
                        console.log('ğŸ”§ ä¿®æ­£åçš„URL:', pdfUrl);
                    }
                } else {
                    // æ‹¼æ¥å®Œæ•´ URL
                    const apiBaseUrl = window.ENV_CONFIG.getApiUrl();
                    if (!pdfUrl.includes('/')) {
                        pdfUrl = `${apiBaseUrl}/files/${pdfUrl}`;
                    } else {
                        const host = apiBaseUrl.replace(/\/api\/?$/, '');
                        pdfUrl = host + (pdfUrl.startsWith('/') ? pdfUrl : '/' + pdfUrl);
                    }
                    console.log('ğŸ”— æ‹¼æ¥åçš„å®Œæ•´URL:', pdfUrl);
                }
            }
            
            // ä¿å­˜åˆ°å…¨å±€å˜é‡
            window.translatedPDFUrl = pdfUrl;
            window.translatedPDFFilename = result.filename || 'translated.pdf';
            
            console.log('ğŸ’¾ å·²ä¿å­˜åˆ°å…¨å±€å˜é‡:');
            console.log('   window.translatedPDFUrl:', window.translatedPDFUrl);
            console.log('   window.translatedPDFFilename:', window.translatedPDFFilename);
            
            // æ›´æ–°ä¿¡æ¯æ˜¾ç¤º
            if (info) {
                const infoText = `æ–‡ä»¶åï¼š${result.filename || 'æœªçŸ¥'}` +
                                `${result.processing_time ? `ï¼Œå¤„ç†æ—¶é—´ï¼š${result.processing_time}` : ''}` +
                                `${result.source_lang ? `ï¼Œæºè¯­è¨€ï¼š${result.source_lang}` : ''}` +
                                `${result.target_lang ? `ï¼Œç›®æ ‡è¯­è¨€ï¼š${result.target_lang}` : ''}`;
                info.textContent = infoText;
            }
            
            // ä¸‹è½½æŒ‰é’®
            if (downloadBtn) {
                downloadBtn.onclick = function() {
                    console.log('ğŸ“¥ å¼€å§‹ä¸‹è½½PDF:', window.translatedPDFUrl);
                    
                    fetch(window.translatedPDFUrl)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                            }
                            return response.blob();
                        })
                        .then(blob => {
                            const url = URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.href = url;
                            link.download = window.translatedPDFFilename;
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);
                            URL.revokeObjectURL(url);
                            console.log('âœ… PDFä¸‹è½½æˆåŠŸ');
                        })
                        .catch(error => {
                            console.error('âŒ PDFä¸‹è½½å¤±è´¥:', error);
                            alert('ä¸‹è½½å¤±è´¥: ' + error.message + '\nè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜');
                        });
                };
            }
            
            // é‡æ–°é€‰æ‹©æŒ‰é’®
            if (reselectBtn) {
                reselectBtn.onclick = function() {
                    card.style.display = 'none';
                    clearPdfFile();
                    
                    // æ˜¾ç¤ºä¸Šä¼ åŒºåŸŸ
                    const uploadArea = document.getElementById('pdfUploadArea');
                    if (uploadArea) uploadArea.style.display = 'block';
                    
                    console.log('âœ… å·²é‡ç½®PDFç¿»è¯‘');
                };
            }
            
            // æ˜¾ç¤ºç»“æœå¡ç‰‡ï¼Œéšè—ä¸Šä¼ åŒºåŸŸ
            card.style.display = 'block';
            
            const uploadArea = document.getElementById('pdfUploadArea');
            const fileInfo = document.getElementById('pdfFileInfo');
            if (uploadArea) uploadArea.style.display = 'none';
            if (fileInfo) fileInfo.style.display = 'none';
            
            console.log('âœ… PDFç¿»è¯‘ç»“æœæ˜¾ç¤ºå®Œæˆ');
        }

        // å›¾ç‰‡ç¿»è¯‘ç›¸å…³å‡½æ•°
        let currentImageFile = null;
        
        // å¤„ç†å›¾ç‰‡æ–‡ä»¶é€‰æ‹©
        function handleImageFile(input) {
            const file = input.files[0];
            if (!file) return;
            
            currentImageFile = file;
            
            // æ˜¾ç¤ºé¢„è§ˆ
            const preview = document.getElementById('imagePreview');
            const previewImage = document.getElementById('previewImage');
            const fileName = document.getElementById('imageFileName');
            const fileSize = document.getElementById('imageFileSize');
            
            previewImage.src = URL.createObjectURL(file);
            fileName.textContent = file.name;
            fileSize.textContent = formatFileSize(file.size);
            preview.style.display = 'block';
            
            // æ›´æ–°ç¿»è¯‘æŒ‰é’®çŠ¶æ€
            updateTranslateButtonState();
        }
        
        // æ›´æ–°ç¿»è¯‘æŒ‰é’®çŠ¶æ€
        function updateTranslateButtonState() {
            const translateBtn = document.getElementById('translateImageBtn');
            // åªè¦æœ‰å›¾ç‰‡æ–‡ä»¶å°±å¯ä»¥ç¿»è¯‘
            translateBtn.disabled = !currentImageFile;
        }
        
        // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // ç¿»è¯‘å›¾ç‰‡
        async function translateImage() {
            if (!currentImageFile) {
                alert('è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶');
                return;
            }
            
            try {
                console.log('å¼€å§‹å›¾ç‰‡ç¿»è¯‘...');
                hideAISummary();
                // æ˜¾ç¤ºè¿›åº¦
                const progressSection = document.getElementById('progressSection');
                if (progressSection) {
                    progressSection.style.display = 'block';
                    document.getElementById('progressText').textContent = 'æ­£åœ¨ç¿»è¯‘å›¾ç‰‡...';
                }
                
                // å‡†å¤‡è¡¨å•æ•°æ®
                const formData = new FormData();
                formData.append('file', currentImageFile);
                
                // ğŸ”¥ ä½¿ç”¨é€šç”¨è¯­è¨€é€‰æ‹©å™¨
                const sourceLang = document.getElementById('sourceLanguage')?.value;
                const targetLang = document.getElementById('targetLanguage')?.value;
                
                // è·å–AIæ€»ç»“å¼€å…³çŠ¶æ€
                const aiSummarySwitch = document.getElementById('aiSummarySwitch');
                const enableSummary = aiSummarySwitch ? aiSummarySwitch.checked : false;
                
                // è½¬æ¢è¯­è¨€ä»£ç 
                const langMap = {
                    'ä¸­æ–‡': 'zh',
                    'è‹±æ–‡': 'en',
                    'auto': 'auto',
                    'zh': 'zh',
                    'en': 'en'
                };
                
                const srcLangCode = langMap[sourceLang] || sourceLang || 'auto';
                const tgtLangCode = langMap[targetLang] || targetLang || 'zh';
                
                // ğŸ”¥ ä¿®å¤ï¼šä½¿ç”¨æ­£ç¡®çš„å‚æ•°å
                formData.append('source_lang', srcLangCode);  // âœ… æ”¹ä¸º source_lang
                formData.append('target_lang', tgtLangCode);  // âœ… æ”¹ä¸º target_lang
                formData.append('enable_summary', enableSummary);

                console.log('ğŸŒ ç¿»è¯‘è¯­è¨€è®¾ç½®:', { 
                    æºè¯­è¨€: sourceLang,
                    ç›®æ ‡è¯­è¨€: targetLang,
                    source_lang: srcLangCode, 
                    target_lang: tgtLangCode,
                    AIæ€»ç»“: enableSummary ? 'âœ“ å¯ç”¨' : 'âœ— ç¦ç”¨'
                });
                
                // ğŸ” è°ƒè¯•ï¼šæ‰“å°FormDataå†…å®¹
                console.log('ğŸ“¦ FormData å†…å®¹:');
                for (let pair of formData.entries()) {
                    console.log(`   ${pair[0]}: ${pair[1]}`);
                }
                
                // è·å–APIåœ°å€
                // const apiBaseUrl = document.querySelector('meta[name="env:API_BASE_URL"]')?.content || 'https://chat.offerupup.cn/translator-api/api';
                // const fullUrl = `${apiBaseUrl}/translate/image`;
                // console.log('ğŸŒ å®Œæ•´è¯·æ±‚URL:', fullUrl);
                
                // ğŸ”¥ ä½¿ç”¨ ENV_CONFIG è·å– API åœ°å€
                const apiBaseUrl = window.ENV_CONFIG.getApiUrl();
                const fullUrl = `${apiBaseUrl}/translate/image`;
                console.log('ğŸŒ å®Œæ•´è¯·æ±‚URL:', fullUrl);
                
                // å‘é€ç¿»è¯‘è¯·æ±‚
                const response = await fetch(fullUrl, {
                    method: 'POST',
                    body: formData
                });
                
                console.log('ğŸ“¥ æ”¶åˆ°å“åº”ï¼ŒçŠ¶æ€ç :', response.status);
                
                const result = await response.json();
                console.log('âœ… å›¾ç‰‡ç¿»è¯‘ç»“æœ:', result);
                
                if (result.success) {
                    showImageTranslationResult(result);
                    
                    // ğŸ”¥ æ–°å¢: æ˜¾ç¤ºAIæ€»ç»“
                    if (result.summary) {
                        displayAISummary(result.summary);
                    } else {
                        hideAISummary();
                    }
                } 
                if (!response.ok || !result.success) {
                    if (result.code === 'NO_TEXT_DETECTED') {
                        // ç‰¹æ®Šæç¤º
                        alert(`âš ï¸ ${result.message || 'æœªæ£€æµ‹åˆ°éœ€è¦ç¿»è¯‘çš„æ–‡æœ¬'}\n\nå¯èƒ½åŸå› ï¼š\nâ€¢ å›¾ç‰‡ä¸­æ²¡æœ‰æ–‡å­—\nâ€¢ æºè¯­è¨€é€‰æ‹©ä¸åŒ¹é…\nâ€¢ å›¾ç‰‡è´¨é‡è¿‡ä½\n\nå»ºè®®ï¼š\n- æ£€æŸ¥å›¾ç‰‡å†…å®¹\n- å°è¯•æ›´æ¢æºè¯­è¨€\n- ä½¿ç”¨æ›´æ¸…æ™°çš„å›¾ç‰‡`);
                    } else {
                        alert(`ç¿»è¯‘å¤±è´¥ï¼š${result.message || result.error}`);
                    }
                    throw new Error(result.message || result.error);
                }
                
            } catch (error) {
                console.error('âŒ å›¾ç‰‡ç¿»è¯‘å¤±è´¥:', error);
                hideAISummary();
            } finally {
                const progressSection = document.getElementById('progressSection');
                if (progressSection) {
                    progressSection.style.display = 'none';
                }
            }
        }
        
        // æ˜¾ç¤ºå›¾ç‰‡ç¿»è¯‘ç»“æœ
        function showImageTranslationResult(result) {
            console.log('ğŸ” æ˜¾ç¤ºç¿»è¯‘ç»“æœï¼Œå®Œæ•´resultå¯¹è±¡:', result);
            
            const resultContainer = document.getElementById('imageResultContainer');
            if (!resultContainer) return;
            
            const originalImage = document.getElementById('originalImage');
            const translatedImage = document.getElementById('translatedImage');
            
            // è®¾ç½®åŸå§‹å›¾ç‰‡
            if (originalImage) {
                originalImage.src = URL.createObjectURL(currentImageFile);
            }
            
            // ğŸ”¥ ä¿®å¤ï¼šæ·»åŠ  translated_filename å­—æ®µ
            const imageUrl = result.translated_filename ||  // â­ æ–°å¢è¿™ä¸ªå­—æ®µ
                           result.translated_image || 
                           result.output_image || 
                           result.download_url || 
                           result.file_url ||
                           result.url ||
                           result.image_url;
            
            console.log('ğŸ” æå–åˆ°çš„imageUrl:', imageUrl);
            console.log('ğŸ” resultä¸­çš„æ‰€æœ‰å­—æ®µ:', Object.keys(result));
            
            // è®¾ç½®ç¿»è¯‘åçš„å›¾ç‰‡
            if (translatedImage && imageUrl) {
                let finalUrl;
                
                // å¦‚æœå·²ç»æ˜¯å®Œæ•´URLï¼Œç›´æ¥ä½¿ç”¨
                if (imageUrl.startsWith('http://') || imageUrl.startsWith('https://')) {
                    finalUrl = imageUrl;
                    console.log('âœ… ä½¿ç”¨å®Œæ•´URL:', finalUrl);
                } else {
                    // å¦åˆ™æ‹¼æ¥APIåœ°å€
                    const apiBaseUrl = window.ENV_CONFIG.getApiUrl();
                    finalUrl = `${apiBaseUrl}/files/${imageUrl}`;
                    console.log('âœ… æ‹¼æ¥åçš„URL:', finalUrl);
                }
                
                translatedImage.src = finalUrl;
                translatedImage.onerror = function() {
                    console.error('âŒ ç¿»è¯‘å›¾ç‰‡åŠ è½½å¤±è´¥!');
                    console.error('   - URL:', finalUrl);
                    console.error('   - å®Œæ•´URL:', this.src);
                };
                translatedImage.onload = function() {
                    console.log('âœ… ç¿»è¯‘å›¾ç‰‡åŠ è½½æˆåŠŸ!');
                };
            } else {
                console.error('âŒ æ— æ³•è·å–ç¿»è¯‘åçš„å›¾ç‰‡URL');
                alert('åç«¯è¿”å›çš„æ•°æ®ä¸­æ²¡æœ‰å›¾ç‰‡URL');
            }
            
            // ä¿å­˜ä¸‹è½½ä¿¡æ¯
            window.translatedImageUrl = imageUrl;
            window.translatedImageFilename = result.translated_filename || result.filename || 'translated_image.jpg';
            
            console.log('ğŸ’¾ ä¿å­˜çš„ä¸‹è½½ä¿¡æ¯:', {
                url: window.translatedImageUrl,
                filename: window.translatedImageFilename
            });
            
            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            resultContainer.style.display = 'block';
        }
        
        // ä¸‹è½½ç¿»è¯‘åçš„å›¾ç‰‡
        function downloadTranslatedImage() {
            if (!window.translatedImageUrl) {
                alert('æ²¡æœ‰å¯ä¸‹è½½çš„ç¿»è¯‘å›¾ç‰‡');
                return;
            }
            
            // ğŸ”¥ ä½¿ç”¨ fetch ä¸‹è½½ï¼Œç¡®ä¿URLæ­£ç¡®
            const downloadUrl = document.getElementById('translatedImage').src;  // â† ç›´æ¥ç”¨imgæ ‡ç­¾çš„src
            
            fetch(downloadUrl)
                .then(response => response.blob())
                .then(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = window.translatedImageFilename || 'translated_image.png';
                    link.click();
                    URL.revokeObjectURL(url);
                })
                .catch(error => {
                    console.error('ä¸‹è½½å¤±è´¥:', error);
                    alert('ä¸‹è½½å¤±è´¥ï¼Œè¯·å³é”®å›¾ç‰‡é€‰æ‹©"å›¾ç‰‡å¦å­˜ä¸º"');
                });
        }
        
        // é‡ç½®å›¾ç‰‡ç¿»è¯‘
        function resetImageTranslation() {
            currentImageFile = null;
            
            // é‡ç½®æ–‡ä»¶é€‰æ‹©
            document.getElementById('imageFileInput').value = '';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('translateImageBtn').disabled = true;
            
            // éšè—ç»“æœ
            document.getElementById('imageResultContainer').style.display = 'none';
            
            // æ¸…ç†URL
            if (window.translatedImageUrl) {
                URL.revokeObjectURL(window.translatedImageUrl);
                window.translatedImageUrl = null;
                window.translatedImageFilename = null;
            }
        }

        // PPTç¿»è¯‘ç›¸å…³å‡½æ•°
        let currentPPTFile = null;

        // å¤„ç†PPTæ–‡ä»¶é€‰æ‹©
        function handlePPTFile(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                
                // éªŒè¯æ–‡ä»¶ç±»å‹
                if (!file.name.toLowerCase().endsWith('.ppt') && !file.name.toLowerCase().endsWith('.pptx')) {
                    alert('è¯·é€‰æ‹© PPT æˆ– PPTX æ ¼å¼çš„æ–‡ä»¶ï¼');
                    input.value = '';
                    return;
                }
                
                currentPPTFile = file;
                
                // æ˜¾ç¤ºPPTé¢„è§ˆä¿¡æ¯
                const preview = document.getElementById('pptPreview');
                const fileName = document.getElementById('pptFileName');
                const fileSize = document.getElementById('pptFileSize');
                const slideCount = document.getElementById('pptSlideCount');
                
                fileName.textContent = file.name;
                fileSize.textContent = formatFileSize(file.size);
                slideCount.textContent = 'ç­‰å¾…ç¿»è¯‘...';
                
                preview.style.display = 'block';
                
                // å¯ç”¨ç¿»è¯‘æŒ‰é’®
                document.getElementById('translatePPTBtn').disabled = false;
                
                console.log('âœ… PPTæ–‡ä»¶å·²é€‰æ‹©:', file.name);
            }
        }

        // PPTç¿»è¯‘å‡½æ•°
        async function translatePPT() {
            if (!currentPPTFile) {
                alert('è¯·å…ˆé€‰æ‹©PPTæ–‡ä»¶');
                return;
            }

            try {
                console.log('ğŸš€ å¼€å§‹PPTç¿»è¯‘...');
                
                // æ˜¾ç¤ºè¿›åº¦
                const progressSection = document.getElementById('progressSection');
                if (progressSection) {
                    progressSection.style.display = 'block';
                    document.getElementById('progressText').textContent = 'æ­£åœ¨ç¿»è¯‘PPTï¼Œè¯·ç¨å€™...';
                }
                
                const translateBtn = document.getElementById('translatePPTBtn');
                translateBtn.disabled = true;
                translateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ç¿»è¯‘ä¸­...';
                
                // åˆ›å»ºFormData
                const formData = new FormData();
                formData.append('file', currentPPTFile);
                
                // è·å–è¯­è¨€å‚æ•°
                const sourceLang = document.getElementById('sourceLanguage')?.value || 'en';
                const targetLang = document.getElementById('targetLanguage')?.value || 'zh';
                // è·å–AIæ€»ç»“å¼€å…³çŠ¶æ€
                const aiSummarySwitch = document.getElementById('aiSummarySwitch');
                const enableSummary = aiSummarySwitch ? aiSummarySwitch.checked : false;
                
                formData.append('source_lang', sourceLang);
                formData.append('target_lang', targetLang);
                formData.append('enable_summary', enableSummary);
                formData.append('simple', 'false');  // å®Œæ•´æ¨¡å¼
        
                console.log('ğŸ“Š PPTç¿»è¯‘å‚æ•°:', {
                    æ–‡ä»¶å: currentPPTFile.name,
                    æºè¯­è¨€: sourceLang,
                    ç›®æ ‡è¯­è¨€: targetLang
                });
                
                // è°ƒç”¨API
                const apiBaseUrl = window.ENV_CONFIG.getApiUrl();
                const fullUrl = `${apiBaseUrl}/translate/ppt`;
                console.log('ğŸŒ PPTè¯·æ±‚URL:', fullUrl);
                
                const response = await fetch(fullUrl, {
                    method: 'POST',
                    body: formData
                });
                
                console.log('ğŸ“¥ æ”¶åˆ°PPTå“åº”ï¼ŒçŠ¶æ€ç :', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                console.log('âœ… PPTç¿»è¯‘ç»“æœ:', result);
                console.log('   - success:', result.success);
                console.log('   - download_url:', result.download_url);
                console.log('   - filename:', result.filename);

                if (result.success) {
                    showPPTTranslationResult(result);
                    // ğŸ”¥ æ–°å¢: æ˜¾ç¤ºAIæ€»ç»“
                    if (result.summary) {
                        displayAISummary(result.summary);
                    } else {
                        hideAISummary();
                    }
                } else {
                    throw new Error(result.error || 'PPTç¿»è¯‘å¤±è´¥');
                }
                
            } catch (error) {
                console.error('âŒ PPTç¿»è¯‘å¤±è´¥:', error);
                alert('ç¿»è¯‘å¤±è´¥: ' + error.message);
            } finally {
                const progressSection = document.getElementById('progressSection');
                if (progressSection) {
                    progressSection.style.display = 'none';
                }
                
                const translateBtn = document.getElementById('translatePPTBtn');
                translateBtn.disabled = false;
                translateBtn.innerHTML = '<i class="fas fa-language"></i> å¼€å§‹ç¿»è¯‘PPT';
            }
        }

        // æ˜¾ç¤ºPPTç¿»è¯‘ç»“æœ
        function showPPTTranslationResult(result) {
            console.log('ğŸ“Š æ˜¾ç¤ºPPTç¿»è¯‘ç»“æœï¼Œå®Œæ•´resultå¯¹è±¡:', result);
            console.log('   æ‰€æœ‰å­—æ®µ:', Object.keys(result));
            
            const resultContainer = document.getElementById('pptResultContainer');
            
            if (!resultContainer) {
                console.error('âŒ æ‰¾ä¸åˆ° pptResultContainer å…ƒç´ ');
                return;
            }
            
            // è·å–ä¸‹è½½ URL
            let pptUrl = result.download_url || 
                         result.translated_ppt_url || 
                         result.file_url ||
                         result.url ||
                         result.translated_filename ||
                         result.filename;
            
            console.log('ğŸ” æå–åˆ°çš„åŸå§‹å€¼:', pptUrl);
            
            // ğŸ”¥ ä¿®å¤ï¼šç»Ÿä¸€ URL æ‹¼æ¥é€»è¾‘ï¼ˆä¸å›¾ç‰‡ç¿»è¯‘ä¿æŒä¸€è‡´ï¼‰
            if (pptUrl) {
                // å¦‚æœå·²ç»æ˜¯å®Œæ•´ URLï¼Œç›´æ¥ä½¿ç”¨
                if (pptUrl.startsWith('http://') || pptUrl.startsWith('https://')) {
                    // âœ… å¦‚æœæ˜¯å®Œæ•´ URLï¼Œæ£€æŸ¥æ˜¯å¦éœ€è¦æ·»åŠ  translator-api å‰ç¼€
                    if (pptUrl.includes('offerupup.cn') && !pptUrl.includes('translator-api')) {
                        // ä¿®å¤ï¼šåœ¨ /api å‰é¢åŠ ä¸Š /translator-api
                        pptUrl = pptUrl.replace('/api/files/', '/translator-api/api/files/');
                        console.log('ğŸ”§ ä¿®æ­£åçš„URL:', pptUrl);
                    }
                } else {
                    // å¦‚æœæ˜¯ç›¸å¯¹è·¯å¾„ï¼Œæ‹¼æ¥å®Œæ•´ URL
                    const apiBaseUrl = window.ENV_CONFIG.getApiUrl();
                    
                    // å¦‚æœæ˜¯æ–‡ä»¶åï¼ˆä¸åŒ…å« /ï¼‰ï¼Œæ‹¼æ¥ /api/files/
                    if (!pptUrl.includes('/')) {
                        pptUrl = `${apiBaseUrl}/files/${pptUrl}`;
                    } else {
                        // å¦‚æœå·²ç»æ˜¯è·¯å¾„ï¼Œç›´æ¥æ‹¼æ¥ä¸»æœº
                        const host = apiBaseUrl.replace(/\/api\/?$/, '');
                        pptUrl = host + (pptUrl.startsWith('/') ? pptUrl : '/' + pptUrl);
                    }
                    
                    console.log('ğŸ”— æ‹¼æ¥åçš„å®Œæ•´URL:', pptUrl);
                }
            }
            
            // ä¿å­˜åˆ°å…¨å±€å˜é‡
            window.translatedPPTUrl = pptUrl;
            window.translatedPPTFilename = result.translated_filename || result.filename || 'translated.pptx';
            
            console.log('ğŸ’¾ å·²ä¿å­˜åˆ°å…¨å±€å˜é‡:');
            console.log('   window.translatedPPTUrl:', window.translatedPPTUrl);
            console.log('   window.translatedPPTFilename:', window.translatedPPTFilename);
            
            // æ›´æ–°UI
            const originalName = document.getElementById('originalPPTName');
            const translatedName = document.getElementById('translatedPPTName');
            const translationStats = document.getElementById('pptTranslationStats');
            
            if (originalName) originalName.textContent = currentPPTFile.name;
            if (translatedName) translatedName.textContent = result.translated_filename || result.filename || 'ç¿»è¯‘å®Œæˆ';
            if (translationStats) {
                translationStats.textContent = `å®Œæˆ (${result.processing_time || 'æœªçŸ¥'})`;
            }
            
            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            resultContainer.style.display = 'block';
            
            // éšè—ä¸Šä¼ åŒºåŸŸ
            const uploadContainer = document.querySelector('.ppt-upload-container');
            const controls = document.querySelector('.ppt-translation-controls');
            if (uploadContainer) uploadContainer.style.display = 'none';
            if (controls) controls.style.display = 'none';
            
            console.log('âœ… PPTç¿»è¯‘ç»“æœæ˜¾ç¤ºå®Œæˆ');
        }

        // ä¸‹è½½ç¿»è¯‘åçš„PPTï¼ˆæ¨¡ä»¿å›¾ç‰‡ä¸‹è½½é€»è¾‘ï¼‰
        function downloadTranslatedPPT() {
            console.log('ğŸ” æ£€æŸ¥ä¸‹è½½é“¾æ¥...');
            console.log('   window.translatedPPTUrl:', window.translatedPPTUrl);
            console.log('   window.translatedPPTFilename:', window.translatedPPTFilename);
            
            if (!window.translatedPPTUrl) {
                console.error('âŒ ä¸‹è½½é“¾æ¥ä¸å­˜åœ¨');
                alert('æ²¡æœ‰å¯ä¸‹è½½çš„ç¿»è¯‘PPTï¼Œè¯·å…ˆç¿»è¯‘æ–‡ä»¶');
                return;
            }
            
            console.log('ğŸ“¥ å¼€å§‹ä¸‹è½½PPT:', window.translatedPPTUrl);
            
            // ğŸ”¥ ä½¿ç”¨ fetch ä¸‹è½½ï¼Œç¡®ä¿URLæ­£ç¡®ï¼ˆä¸å›¾ç‰‡ä¸‹è½½é€»è¾‘å®Œå…¨ä¸€è‡´ï¼‰
            const downloadUrl = window.translatedPPTUrl;
            
            fetch(downloadUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.blob();
                })
                .then(blob => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = window.translatedPPTFilename || 'translated.pptx';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    console.log('âœ… PPTä¸‹è½½æˆåŠŸ');
                })
                .catch(error => {
                    console.error('âŒ PPTä¸‹è½½å¤±è´¥:', error);
                    alert('ä¸‹è½½å¤±è´¥: ' + error.message + '\nè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜');
                });
        }

        // é‡ç½®PPTç¿»è¯‘
        function resetPPTTranslation() {
            currentPPTFile = null;
            
            // é‡ç½®æ–‡ä»¶é€‰æ‹©
            const fileInput = document.getElementById('pptFileInput');
            const preview = document.getElementById('pptPreview');
            const translateBtn = document.getElementById('translatePPTBtn');
            const resultContainer = document.getElementById('pptResultContainer');
            const uploadContainer = document.querySelector('.ppt-upload-container');
            const controls = document.querySelector('.ppt-translation-controls');
            
            if (fileInput) fileInput.value = '';
            if (preview) preview.style.display = 'none';
            if (translateBtn) translateBtn.disabled = true;
            if (resultContainer) resultContainer.style.display = 'none';
            if (uploadContainer) uploadContainer.style.display = 'block';
            if (controls) controls.style.display = 'block';
            
            // æ¸…ç†ä¸‹è½½é“¾æ¥
            window.translatedPPTUrl = null;
            window.translatedPPTFilename = null;
            
            console.log('âœ… PPTç¿»è¯‘å·²é‡ç½®');
        }
    </script>
</body>
</html>